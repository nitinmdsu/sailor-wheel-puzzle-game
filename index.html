<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<title> Sailor wheel puzzle </title>
		<style> 
			* { padding: 0; margin: 0; }
			canvas { background: #eee; display: block; margin: 0 auto; }
		</style> 
	</head>
	<body>
		<p> Just a regular web page, but with a canvas element.</p>
		<canvas id="game" width="640" height="480"> Canvas goes here! </canvas>
		<script>

			var canvas = document.getElementById('game');
			var ctx    = canvas.getContext('2d');

			var centX = canvas.width/2
			var centY = canvas.height/2
			

			var rule1 = function(spoke_state) { 
				// TODO: change spoke state according to rules
				spoke_state[Math.floor((Math.random() * num_spokes) + 1)] = 1 - spoke_state[Math.floor((Math.random() * num_spokes) + 1)];
				spoke_state[Math.floor((Math.random() * num_spokes) + 1)] = 1 - spoke_state[Math.floor((Math.random() * num_spokes) + 1)];
				spoke_state[Math.floor((Math.random() * num_spokes) + 1)] = 1 - spoke_state[Math.floor((Math.random() * num_spokes) + 1)];
				spoke_state[Math.floor((Math.random() * num_spokes) + 1)] = 1 - spoke_state[Math.floor((Math.random() * num_spokes) + 1)];
				spoke_state[Math.floor((Math.random() * num_spokes) + 1)] = 1 - spoke_state[Math.floor((Math.random() * num_spokes) + 1)];
				spoke_state[Math.floor((Math.random() * num_spokes) + 1)] = 1 - spoke_state[Math.floor((Math.random() * num_spokes) + 1)];
				spoke_state[Math.floor((Math.random() * num_spokes) + 1)] = 1 - spoke_state[Math.floor((Math.random() * num_spokes) + 1)];
				spoke_state[Math.floor((Math.random() * num_spokes) + 1)] = 1 - spoke_state[Math.floor((Math.random() * num_spokes) + 1)];
				return spoke_state;
				// we could have a matrix. 6x6 matrix in this case.
				// diag elements are 1, and elem [i,j] will be an integer say 1, 0 or -1... 
				//  0 implies ith spoke has no effect on jth. 
				//  1 implies toggle, i.e., modifying ith spoke WILL modify jth irrespective of i's, j's positions. 
				// -1 could imply a conditional toggle like if I push in ith spoke, 
				//    then jth spoke will be pushed in along with it, but pulling i won't affect j. And so on...
			}

			function draw_line(x, y){
				ctx.lineWidth = 600/num_spokes; //thickness
				ctx.strokeStyle = "red";
				ctx.beginPath();
				ctx.moveTo(centX, centY);
				ctx.lineTo(x,y);
				ctx.stroke();
			}

			var draw_spokes = function (spoke_state) {
				for (i = 0; i < num_spokes; i++) {
					r = spoke_state[i] === 1 ? 250 : 180
					draw_line(centX + r * Math.cos(i * 2 * Math.PI / num_spokes ), centY - r * Math.sin(i * 2 * Math.PI / num_spokes))
				}
			}

			var draw_wheel = function() {
				ctx.fillStyle   = "gold";
				ctx.lineWidth   = 1;
				ctx.beginPath();
				ctx.arc(centX, centY, 120, 0, 2 * Math.PI);
				ctx.closePath();
				ctx.fill();
			}
			

			draw_frame = function() { // Grand draw at the end to call everything else
				ctx.clearRect(0, 0, canvas.width, canvas.height);
				draw_spokes(curr_spoke_state);
				draw_wheel();
				// Animation logic etc. goes here, will have to refer back to mdn breakout tutorial
				console.log(curr_spoke_state)
				curr_spoke_state = rule1(curr_spoke_state);		
			}

			var curr_spoke_state = Array(200).fill(1); 
			//var curr_spoke_state = [0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0];
			num_spokes = curr_spoke_state.length;
			draw_frame();
			setInterval(draw_frame, 1);

			// So next steps are just to figure out mouse input 
		</script>
	</body>
</html>

